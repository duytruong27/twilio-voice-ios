<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>TwilioVoice Class Reference</title>

	<link rel="stylesheet" href="../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../index.html">Twilio Voice </a>
			</h1>

			<p id="developer-home">
				<a href="../index.html">Twilio</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../index.html">Index</a></li>
<li><a href="../hierarchy.html">Hierarchy</a></li>

					<li id="on-this-page" role="navigation">
						<label>
							On This Page

							<div class="chevron">
								<div class="chevy chevron-left"></div>
								<div class="chevy chevron-right"></div>
							</div>

							<select id="jump-to">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	

	
	
	<option value="tasks">Tasks</option>
	
	

	
	
	<optgroup label="Properties">
		
		<option value="//api/name/audioDevice">audioDevice</option>
		
		<option value="//api/name/logLevel">logLevel</option>
		
	</optgroup>
	

	
	<optgroup label="Class Methods">
		
		<option value="//api/name/connectWithAccessToken:delegate:">+ connectWithAccessToken:delegate:</option>
		
		<option value="//api/name/connectWithOptions:delegate:">+ connectWithOptions:delegate:</option>
		
		<option value="//api/name/handleNotification:delegate:">+ handleNotification:delegate:</option>
		
		<option value="//api/name/logLevelForModule:">+ logLevelForModule:</option>
		
		<option value="//api/name/registerWithAccessToken:deviceToken:completion:">+ registerWithAccessToken:deviceToken:completion:</option>
		
		<option value="//api/name/sdkVersion">+ sdkVersion</option>
		
		<option value="//api/name/setLogLevel:module:">+ setLogLevel:module:</option>
		
		<option value="//api/name/unregisterWithAccessToken:deviceToken:completion:">+ unregisterWithAccessToken:deviceToken:completion:</option>
		
	</optgroup>
	

	
	
</select>
						</label>
					</li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview_contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">TwilioVoice Class Reference</h1>

					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<th>Inherits from</th>
	<td>NSObject</td>
</tr><tr>
	<th>Declared in</th>
	<td>TwilioVoice.h</td>
</tr>
						</tbody></table></div>
					

                    
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p><code>TwilioVoice</code> is the entry point to the Twilio Voice SDK. You can register for VoIP push notifications, make outgoing
Calls, receive Call invites and set audio device to use in a Call using this class.</p>

<p>CallKit Audio Session Handling</p>
					</div>
					
					

					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						

						
						<h2 class="task-title">Other Methods</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/logLevel" title="logLevel"></a>
	<h3 class="method-title"><code><a href="#//api/name/logLevel">&nbsp;&nbsp;logLevel</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The current logging level used by the SDK.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, assign, class) TVOLogLevel logLevel</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>The default logging level is <code>TVOLogLevelError</code>. <code>TwilioVoice</code> and its components use NSLog internally.</p>
			</div>
			

			

			
			<div class="method-subsection see-also-section">
				<h4 class="method-subtitle">See Also</h4>
				<ul>
					
					<li><code><p><a href="../Constants/TVOLogLevel.html">TVOLogLevel</a></p></code></li>
					
				</ul>
			</div>
			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/audioDevice" title="audioDevice"></a>
	<h3 class="method-title"><code><a href="#//api/name/audioDevice">&nbsp;&nbsp;audioDevice</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The <code>TVOAudioDevice</code> used to record and playback audio in a Call.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (class, nonatomic, strong, nonnull) id&lt;TVOAudioDevice&gt; audioDevice</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>If you wish to provide your own <code>TVOAudioDevice</code> then you must set it before performing any other
actions with the SDK like connecting to a Call. It is also possible to change the device when you are no longer
connected to any Calls and have destroyed all other SDK objects.</p>
			</div>
			

			

			
			<div class="method-subsection see-also-section">
				<h4 class="method-subtitle">See Also</h4>
				<ul>
					
					<li><code><p><a href="TVOAudioDevice.h">TVOAudioDevice</a></p></code></li>
					
				</ul>
			</div>
			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/sdkVersion" title="sdkVersion"></a>
	<h3 class="method-title"><code><a href="#//api/name/sdkVersion">+&nbsp;sdkVersion</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Returns the version of the SDK.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (nonnull NSString *)sdkVersion</code></div>

		    
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The version of the SDK.</p>
			</div>
			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/setLogLevel:module:" title="setLogLevel:module:"></a>
	<h3 class="method-title"><code><a href="#//api/name/setLogLevel:module:">+&nbsp;setLogLevel:module:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Sets the logging level for an individual module.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (void)setLogLevel:(TVOLogLevel)<em>logLevel</em> module:(TVOLogModule)<em>module</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>logLevel</code></th>
						<td><p>The <a href="../Constants/TVOLogLevel.html"><code>TVOLogLevel</code></a> level to be used by the module.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>module</code></th>
						<td><p>The <a href="../Constants/TVOLogModule.html"><code>TVOLogModule</code></a> for which the logging level is to be set.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			

			

			
			<div class="method-subsection see-also-section">
				<h4 class="method-subtitle">See Also</h4>
				<ul>
					
					<li><code><p><a href="../Constants/TVOLogLevel.html">TVOLogLevel</a></p></code></li>
					
					<li><code><p><a href="../Constants/TVOLogModule.html">TVOLogModule</a></p></code></li>
					
				</ul>
			</div>
			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/logLevelForModule:" title="logLevelForModule:"></a>
	<h3 class="method-title"><code><a href="#//api/name/logLevelForModule:">+&nbsp;logLevelForModule:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Retrieve the log level for a specific module in the TwilioVoice SDK.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (TVOLogLevel)logLevelForModule:(TVOLogModule)<em>module</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>module</code></th>
						<td><p>The <code>TVOLogModule</code> for which the log level needs to be set.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The current log level for the specified module.</p>
			</div>
			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						

						<a title="Managing VoIP Push Notifications" name="task_Managing VoIP Push Notifications"></a>
						<h2 class="task-title">Managing VoIP Push Notifications</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/registerWithAccessToken:deviceToken:completion:" title="registerWithAccessToken:deviceToken:completion:"></a>
	<h3 class="method-title"><code><a href="#//api/name/registerWithAccessToken:deviceToken:completion:">+&nbsp;registerWithAccessToken:deviceToken:completion:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Registers for Twilio VoIP push notifications.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (void)registerWithAccessToken:(nonnull NSString *)<em>accessToken</em> deviceToken:(nonnull NSString *)<em>deviceToken</em> completion:(nullable void ( ^ ) ( NSError *__nullable error ))<em>completion</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>accessToken</code></th>
						<td><p>Twilio Access Token.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>deviceToken</code></th>
						<td><p>The push registry token for Apple VoIP Service.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>completion</code></th>
						<td><p>Callback block to receive the result of the registration.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>Registering for push notifications is required to receive incoming call notification messages through Twilio&rsquo;s
   infrastructure. Once successfully registered, the registered binding has a time-to-live(TTL) of 1 year. If the registered binding
   is inactive for 1 year it is deleted and push notifications to the registered identity will not succeed. However, whenever
   the registered binding is used to reach the registered identity the TTL is reset to 1 year. A successful registration will
   ensure that push notifications will arrive via the APNs for the lifetime of the registration device token provided by
   the APNs instance.</p><p>The identity provided in the Access Token may only contain alpha-numeric and underscore
   characters. Other characters, including spaces, will result in undefined behavior.</p>

<p>   If the registration is successful the completion handler will contain a <code>Null NSError</code>. If the registration
   fails, the completion handler will have a <code>nonnull NSError</code> with <code>UserInfo</code> string describing the reason for failure.</p>

<p>   <table border="1" summary="Registration Errors.">
   <tr>
   <td>Registration Error</td><td>Error Code</td><td>Description</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenInvalidError </td><td>20101</td><td>Twilio was unable to validate your Access Token</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenHeaderInvalidError </td><td>20102</td><td>Invalid Access Token header</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenIssuerInvalidError </td><td>20103</td><td>Invalid Access Token issuer or subject</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenExpiredError </td><td>20104</td><td>Access Token has expired or expiration date is invalid</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenNotYetValidError </td><td>20105</td><td>Access Token not yet valid</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenGrantsInvalidError </td><td>20106</td><td>Invalid Access Token grants</td>
   </tr>
   <tr>
   <td> TVOErrorExpirationTimeExceedsMaxTimeAllowedError </td><td>20157</td><td>Expiration Time in the Access Token Exceeds Maximum Time Allowed</td>
   </tr>
   <tr>
   <td> TVOErrorAccessForbiddenError </td><td>20403</td><td>Forbidden. The account lacks permission to access the Twilio API</td>
   </tr>
   <tr>
   <td> TVOErrorTokenAuthenticationRejected </td><td>51007</td><td>Token authentication is rejected by authentication service</td>
   </tr>
   <tr>
   <td> TVOErrorRegistrationError </td><td>31301</td><td>Registration failed. Look at [error localizedFailureReason] for details</td>
   </tr>
   </table></p>

<p>   <strong>Insights</strong></p>

<p>   <table border="1" summary="Insights events.">
   <tr>
   <td>Group Name</td><td>Event Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td>registration</td><td>registration</td><td>Registration is successful</td><td>3.0.0-beta3</td>
   </tr>
   <tr>
   <td> registration </td> <td>registration-error</td><td>Registration failed</td><td>3.0.0-beta3</td>
   </tr>
   </table></p>

<p>   <strong> An example of using the <em>registration</em> API </strong></p>

<pre><code>[TwilioVoice registerWithAccessToken:accessToken
    deviceToken:deviceToken
    completion:^(NSError *error) {
        if(error != nil) {
            NSLog("Failed to register for incoming push: %@\n\t  - reason: %@", [error localizedDescription], [error localizedFailureReason]);
        } else {
            NSLog("Registration successful");
        }
}];
</code></pre>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/unregisterWithAccessToken:deviceToken:completion:" title="unregisterWithAccessToken:deviceToken:completion:"></a>
	<h3 class="method-title"><code><a href="#//api/name/unregisterWithAccessToken:deviceToken:completion:">+&nbsp;unregisterWithAccessToken:deviceToken:completion:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Unregisters from Twilio VoIP push notifications.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (void)unregisterWithAccessToken:(nonnull NSString *)<em>accessToken</em> deviceToken:(nonnull NSString *)<em>deviceToken</em> completion:(nullable void ( ^ ) ( NSError *__nullable error ))<em>completion</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>accessToken</code></th>
						<td><p>Twilio Access Token.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>deviceToken</code></th>
						<td><p>The push registry token for Apple VoIP Service.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>completion</code></th>
						<td><p>Callback block to receive the result of the unregistration.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>Call this method when you no longer want to receive push notifications for incoming Calls.</p><p>The identity provided in the Access Token may only contain alpha-numeric and underscore
   characters. Other characters, including spaces, will result in undefined behavior.</p>

<p>   If the unregistration is successful the completion handler will contain a <code>Null NSError</code>. If the unregistration
   fails, the completion handler will have a <code>nonnull NSError</code> with <code>UserInfo</code> string describing the reason for failure.</p>

<p>   <table border="1" summary="Registration Errors.">
   <tr>
   <td>Registration Error</td><td>Error Code</td><td>Description</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenInvalidError </td><td>20101</td><td>Twilio was unable to validate your Access Token</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenHeaderInvalidError </td><td>20102</td><td>Invalid Access Token header</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenIssuerInvalidError </td><td>20103</td><td>Invalid Access Token issuer or subject</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenExpiredError </td><td>20104</td><td>Access Token has expired or expiration date is invalid</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenNotYetValidError </td><td>20105</td><td>Access Token not yet valid</td>
   </tr>
   <tr>
   <td> TVOErrorAccessTokenGrantsInvalidError </td><td>20106</td><td>Invalid Access Token grants</td>
   </tr>
   <tr>
   <td> TVOErrorExpirationTimeExceedsMaxTimeAllowedError </td><td>20157</td><td>Expiration Time in the Access Token Exceeds Maximum Time Allowed</td>
   </tr>
   <tr>
   <td> TVOErrorAccessForbiddenError </td><td>20403</td><td>Forbidden. The account lacks permission to access the Twilio API</td>
   </tr>
   <tr>
   <td> TVOErrorTokenAuthenticationRejected </td><td>51007</td><td>Token authentication is rejected by authentication service</td>
   </tr>
   <tr>
   <td> TVOErrorRegistrationError </td><td>31301</td><td>Registration failed. Look at [error localizedFailureReason] for details</td>
   </tr>
   </table></p>

<p>   <strong>Insights</strong></p>

<p>   <table border="1" summary="Insights events.">
   <tr>
   <td>Group Name</td><td>Event Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td>registration</td><td>unregistration</td><td>Unregistration is successful</td><td>3.0.0-beta3</td>
   </tr>
   <tr>
   <td>registration</td><td>unregistration-error</td><td>Unregistration failed</td><td>3.0.0-beta3</td>
   </tr>
   </table></p>

<p>   <strong> An example of using the <em>unregistration</em> API </strong></p>

<pre><code>[TwilioVoice unregisterWithAccessToken:accessToken
    deviceToken:deviceToken
    completion:^(NSError *error) {
        if(error != nil) {
            NSLog("Failed to unregister for incoming push: %@\n\t  - reason: %@", [error localizedDescription], [error localizedFailureReason]);
        } else {
            NSLog("Unregistration successful");
        }
}];
</code></pre>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/handleNotification:delegate:" title="handleNotification:delegate:"></a>
	<h3 class="method-title"><code><a href="#//api/name/handleNotification:delegate:">+&nbsp;handleNotification:delegate:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Processes an incoming VoIP push notification payload.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (BOOL)handleNotification:(nonnull NSDictionary *)<em>payload</em> delegate:(nonnull id&lt;TVONotificationDelegate&gt;)<em>delegate</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>payload</code></th>
						<td><p>Push notification payload.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>delegate</code></th>
						<td><p>A <a href="../Protocols/TVONotificationDelegate.html"><code>TVONotificationDelegate</code></a> to receive incoming push notification callbacks.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A BOOL value that indicates whether the payload is a valid notification sent by Twilio.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>This method will synchronously process call notification payload and call the provided delegate
   on the same dispatch queue.</p>

<p>   Twilio sends two types of notifications via Apple VoIP Service, <code>call</code> and <code>cancel</code>.
   The notification type is encoded in the dictionary with the key <code>twi_message_type</code> and the values
   <code>twilio.voice.call</code> and <code>twilio.voice.cancel</code>.</p>

<p>   A <code>call</code> notification is sent when someone wants to reach the registered <code>identity</code>.
   Passing a <code>call</code> notification into this method will result in a <code>callInviteReceived:</code> callback with a <a href="../Classes/TVOCallInvite.html"><code>TVOCallInvite</code></a>
   object and return <code>YES</code>.</p>

<p>   A <code>cancel</code> notification is sent to an <code>identity</code> for the following reasons:</p>

<ul>
<li> call made to this <code>identity</code> is prematurely <code>disconnected</code> by the caller</li>
<li> call is <code>rejected</code></li>
<li> call is <code>ignored</code></li>
<li> call is <code>accepted</code> due to an outstanding infrastructure issue.</li>
</ul>


<p>   When a call is accepted, a <code>cancel</code> notification is sent to all the devices that have been registered with the <code>identity</code>
   accepting the call, even to the device that accepted the call. It is recommended that in this case the developer checks
   whether the call sid of <a href="../Classes/TVOCancelledCallInvite.html"><code>TVOCancelledCallInvite</code></a> matches the accepted call, and if so disregard it.</p>

<p>   Passing a <code>cancel</code> notification into this method will result in a <code>cancelledCallInviteReceived:</code> callback with
   a <a href="../Classes/TVOCancelledCallInvite.html"><code>TVOCancelledCallInvite</code></a> object and return <code>YES</code>.</p>

<p>   <strong>Insights</strong></p>

<p>   <table border="1" summary="Insights events.">
   <tr>
   <td>Group Name</td><td>Event Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td>connection</td><td>incoming</td><td>Incoming call notification received</td><td>3.0.0-preview1</td>
   </tr>
   </table></p>

<p>   <strong> An example of using the <em>handleNotification</em> API </strong></p>

<pre><code>@interface CallViewController () &lt;PKPushRegistryDelegate, TVONotificationDelegate, TVOCallDelegate, ... &gt;

// property declarations

@end

@implementation CallViewController

// ViewController setup and other code ...

#pragma mark - PKPushRegistryDelegate

- (void)pushRegistry:(PKPushRegistry *)registry
    didReceiveIncomingPushWithPayload:(PKPushPayload *)payload
    forType:(NSString *)type {
        NSLog(@"Received incoming push: %@", payload.dictionaryPayload);

        if ([type isEqualToString:PKPushTypeVoIP]) {
            if (![TwilioVoice handleNotification:payload.dictionaryPayload delegate:self]) {
                NSLog(@"The push notification was not a Twilio Voice push notification");
        }
    }
}

#pragma mark - TVONotificationDelegate methods

- (void)callInviteReceived:(TVOCallInvite *)callInvite {
    // handle call invite
}

- (void)cancelledCallInviteReceived:(TVOCancelledCallInvite *)cancelledCallInvite {
    // handle cancelled call invite
}

@end
</code></pre>
			</div>
			

			

			
			<div class="method-subsection see-also-section">
				<h4 class="method-subtitle">See Also</h4>
				<ul>
					
					<li><code><p><a href="../Protocols/TVONotificationDelegate.html">TVONotificationDelegate</a></p></code></li>
					
				</ul>
			</div>
			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/connectWithAccessToken:delegate:" title="connectWithAccessToken:delegate:"></a>
	<h3 class="method-title"><code><a href="#//api/name/connectWithAccessToken:delegate:">+&nbsp;connectWithAccessToken:delegate:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Make an outgoing Call.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (nonnull TVOCall *)connectWithAccessToken:(nonnull NSString *)<em>accessToken</em> delegate:(nonnull id&lt;TVOCallDelegate&gt;)<em>delegate</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>accessToken</code></th>
						<td><p>The access token.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>delegate</code></th>
						<td><p>A <a href="../Protocols/TVOCallDelegate.html"><code>TVOCallDelegate</code></a> to receive Call state updates.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A <a href="../Classes/TVOCall.html"><code>TVOCall</code></a> object.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>This method is guaranteed to return a <a href="../Classes/TVOCall.html"><code>TVOCall</code></a> object. It&rsquo;s possible for the returned Call to either
   succeed or fail to connect.</p><p>The identity provided in the Access Token may only contain alpha-numeric and underscore
   characters. Other characters, including spaces, will result in undefined behavior.</p>

<p>   The <a href="../Protocols/TVOCallDelegate.html"><code>TVOCallDelegate</code></a> will receive the Call state update callbacks. The callbacks are listed here.</p>

<p>   <table border="1" summary="TVOCallDelegate events.">
   <tr>
   <td>Callback Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td> call:didFailToConnectWithError </td><td>The call failed to connect. An <code>NSError</code> object provides details of the root cause.</td><td>3.0.0-preview1</td>
   </tr>
   <tr>
   <td> callDidStartRinging </td><td>Emitted once before the <code>callDidConnect</code> callback when the callee is being alerted of a Call.</td><td>3.0.0-preview2</td>
   </tr>
   <tr>
   <td> callDidConnect </td><td>The Call has connected.</td><td>3.0.0-preview1</td>
   </tr>
   <tr>
   <td> call:didDisconnectWithError </td><td>The Call was disconnected. If the Call ends due to an error the <code>NSError</code> is non-null. If the call ends normally <code>NSError</code> is nil.</td><td>3.0.0-preview1</td>
   </tr>
   </table></p>

<p>   If connect fails, <code>didFailToConnectWithError</code> or <code>didDisconnectWithError</code> callback is raised with an <code>NSError</code> object. <code>[error localizedDescription]</code>,
   <code>[error localizedFailureReason]</code> and <code>[error code]</code> provide details of the failure.</p>

<p>   If any authentication error occurs then the SDK will receive one of the following errors.</p>

<p>   <table border="1" summary="Call Connect errors">
   <tr>
   <td>Authentication Errors</td><td>Error Code</td><td>Description</td>
   </tr>
   <tr>
   <td>TVOErrorAccessTokenInvalidError</td><td>20101</td><td>Twilio was unable to validate your Access Token</td>
   </tr>
   <tr>
   <td>TVOErrorAccessTokenHeaderInvalidError</td><td>20102</td><td>Invalid Access Token header</td>
   </tr>
   <tr>
   <td>TVOErrorAccessTokenIssuerInvalidError</td><td>20103</td><td>Invalid Access Token issuer or subject</td>
   </tr>
   <tr>
   <td>TVOErrorAccessTokenExpiredError</td><td>20104</td><td>Access Token has expired or expiration date is invalid</td>
   </tr>
   <tr>
   <td>TVOErrorAccessTokenNotYetValidError</td><td>20105</td><td>Access Token not yet valid</td>
   </tr>
   <tr>
   <td>TVOErrorAccessTokenGrantsInvalidError</td><td>20106</td><td>Invalid Access Token grants</td>
   </tr>
   <tr>
   <td>TVOErrorExpirationTimeExceedsMaxTimeAllowedError</td><td>20157</td><td>Expiration Time in the Access Token Exceeds Maximum Time Allowed</td>
   </tr>
   <tr>
   <td>TVOErrorAccessForbiddenError</td><td>20403</td><td>Forbidden. The account lacks permission to access the Twilio API</td>
   </tr>
   <tr>
   <td>TVOErrorApplicationNotFoundError</td><td>21218</td><td>Invalid ApplicationSid</td>
   </tr>
   </table></p>

<p>   If any connection fails because of any other error then the SDK will receive one of the following errors.</p>

<p>   <table border="1" summary="Call Connect errors">
   <tr>
   <td>Connection Errors</td><td>Error Code</td><td>Description</td>
   </tr>
   <tr>
   <td>TVOErrorConnectionTimeoutError</td><td>31003</td><td>Connection timeout</td>
   </tr>
   <tr>
   <td>TVOErrorConnectionError</td><td>31005</td><td>Connection error</td>
   </tr>
   <tr>
   <td>TVOErrorCallCancelledError</td><td>31008</td><td>Call Cancelled</td>
   </tr>
   <tr>
   <td>TVOErrorMalformedRequestError</td><td>31100</td><td>Malformed request</td>
   </tr>
   <tr>
   <td>TVOErrorAuthorizationError</td><td>31201</td><td>Authorization error</td>
   </tr>
   <tr>
   <td>TVOErrorMicrophoneAccessDenialError</td><td>31208</td><td>User denied access to microphone</td>
   </tr>
   <tr>
   <td>TVOErrorSignalingConnectionError</td><td>53000</td><td>Signaling connection error</td>
   </tr>
   <tr>
   <td>TVOErrorSignalingConnectionDisconnectedError</td><td>53001</td><td>Signaling connection disconnected</td>
   </tr>
   <tr>
   <td>TVOErrorSignalingConnectionTimeoutError</td><td>53002</td><td>Signaling connection timed out</td>
   </tr>
   <tr>
   <td>TVOErrorSignalingIncomingMessageInvalidError</td><td>53003</td><td>Client received an invalid signaling message</td>
   </tr>
   <tr>
   <td>TVOErrorSignalingOutgoingMessageInvalidError</td><td>53004</td><td>Client sent an invalid signaling message</td>
   </tr>
   <tr>
   <td>TVOErrorMediaClientLocalDescFailedError</td><td>53400</td><td>Client is unable to create or apply a local media description</td>
   </tr>
   <tr>
   <td>TVOErrorMediaServerLocalDescFailedError</td><td>53401</td><td>Server is unable to create or apply a local media description</td>
   </tr>
   <tr>
   <td>TVOErrorMediaClientRemoteDescFailedError</td><td>53402</td><td>Client is unable to apply a remote media description</td>
   </tr>
   <tr>
   <td>TVOErrorMediaServerRemoteDescFailedError</td><td>53403</td><td>Server is unable to apply a remote media description</td>
   </tr>
   <tr>
   <td>TVOErrorMediaNoSupportedCodecError</td><td>53404</td><td>No supported codec</td>
   </tr>
   <tr>
   <td>TVOErrorMediaConnectionError</td><td>53405</td><td>Media connection failed</td>
   </tr>
   <tr>
   <td>TVOErrorConfigurationAcquireFailedError</td><td>53500</td><td>Unable to acquire configuration</td>
   </tr>
   <tr>
   <td>TVOErrorConfigurationAcquireTurnFailedError</td><td>53501</td><td>Unable to acquire TURN credentials</td>
   </tr>
   </table></p>

<p>   <strong>Insights</strong></p>

<p>   <table border="1" summary="Insights events.">
   <tr>
   <td>Group Name</td><td>Event Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td>connection</td><td>outgoing</td><td>Outgoing call is made</td><td>3.0.0-beta2</td>
   </tr>
   <tr>
   <td>connection</td><td>ringing</td><td>Call state transitions to ringing</td><td>3.0.0-beta2</td>
   </tr>
   <tr>
   <td>connection</td><td>connected</td><td>Call state transitions to connected</td><td>3.0.0-beta2</td>
   </tr>
   </table></p>

<p>   If connection fails then an error event will be published.</p>

<p>   <table border="1" summary="Insights events.">
   <tr>
   <td>Group Name</td><td>Event Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td>connection</td><td>error</td><td>error description</td><td>3.0.0-beta2</td>
   </tr>
   </table></p>

<p>   <strong> An example of using the <em>connectWithAccessToken:delegate:</em> API </strong></p>

<pre><code>@interface CallViewController () &lt;TVOCallDelegate, ... &gt;

// property declarations

@end

@implementation CallViewController

// ViewController setup and other code ...

- (void)makeCall:(NSString*)accessToken
    self.call = [TwilioVoice connectWithAccessToken:accessToken delegate:self];
}

#pragma mark - TVOCallDelegate

- (void)callDidStartRinging:(TVOCall *)call {
    NSLog(@"Call is ringing at called party %@", call.to);
}

- (void)call:(TVOCall *)call didFailToConnectWithError:(NSError *)error {
    NSLog("Failed to Connect the Call: %@\n\t  - reason: %@", [error localizedDescription], [error localizedFailureReason]);
}

- (void)call:(TVOCall *)call didDisconnectWithError:(NSError *)error {
    if (error) {
        NSLog(@"Call disconnected with error: %@", error);
    } else {
        NSLog(@"Call disconnected");
    }
}

- (void)callDidConnect:(TVOCall *)call {
    NSLog(@"Call connected.");
}

@end
</code></pre>
			</div>
			

			

			
			<div class="method-subsection see-also-section">
				<h4 class="method-subtitle">See Also</h4>
				<ul>
					
					<li><code><p><a href="../Classes/TVOCall.html">TVOCall</a></p></code></li>
					
					<li><code><p><a href="../Protocols/TVOCallDelegate.html">TVOCallDelegate</a></p></code></li>
					
				</ul>
			</div>
			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/connectWithOptions:delegate:" title="connectWithOptions:delegate:"></a>
	<h3 class="method-title"><code><a href="#//api/name/connectWithOptions:delegate:">+&nbsp;connectWithOptions:delegate:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Make an outgoing Call.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (nonnull TVOCall *)connectWithOptions:(nonnull TVOConnectOptions *)<em>options</em> delegate:(nonnull id&lt;TVOCallDelegate&gt;)<em>delegate</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>options</code></th>
						<td><p>The connect options.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>delegate</code></th>
						<td><p>A <a href="../Protocols/TVOCallDelegate.html"><code>TVOCallDelegate</code></a> to receive Call state updates.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A <a href="../Classes/TVOCall.html"><code>TVOCall</code></a> object.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>This method is guaranteed to return a <a href="../Classes/TVOCall.html"><code>TVOCall</code></a> object. It&rsquo;s possible for the returned Call to either
   succeed or fail to connect. Use the <a href="../Classes/TVOConnectOptions.html"><code>TVOConnectOptions</code></a> builder to specify Call parameters and UUID.</p>

<p>   The <a href="../Protocols/TVOCallDelegate.html"><code>TVOCallDelegate</code></a> will receive the Call state update callbacks. The callbacks are same as <code>connectWithAccessToken:delegate:</code> API.</p>

<p>   If connect fails, <code>call:didFailToConnectWithError</code> or <code>call:didDisconnectWithError</code> callback is raised with an <code>NSError</code> object. <code>[error localizedDescription]</code>,
   <code>[error localizedFailureReason]</code> and <code>[error code]</code> provide details of the failure. The error codes are same as <code>connectWithAccessToken:delegate:</code> API.</p>

<p>   <strong>Insights</strong></p>

<p>   <table border="1" summary="Insights events.">
   <tr>
   <td>Group Name</td><td>Event Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td>connection</td><td>outgoing</td><td>Outgoing call is made</td><td>3.0.0-beta2</td>
   </tr>
   <tr>
   <td>connection</td><td>ringing</td><td>Call state transitions to ringing</td><td>3.0.0-beta2</td>
   </tr>
   <tr>
   <td>connection</td><td>connected</td><td>Call state transitions to connected</td><td>3.0.0-beta2</td>
   </tr>
   </table></p>

<p>   If connection fails then an error event will be published.</p>

<p>   <table border="1" summary="Insights events.">
   <tr>
   <td>Group Name</td><td>Event Name</td><td>Description</td><td>Since version</td>
   </tr>
   <tr>
   <td>connection</td><td>error</td><td>error description</td><td>3.0.0-beta2</td>
   </tr>
   </table></p>

<p>   <strong> An example of using the <em>connectWithAccessToken:delegate</em> API </strong></p>

<pre><code>@interface CallViewController () &lt;TVOCallDelegate, ... &gt;

// property declarations

@end

@implementation CallViewController

// ViewController setup and other code ...

- (void)makeCall:(NSString *)accessToken uuid:(NSString *)uuid region:(NSString *)region to:(NSString *)phoneNumber
    NSMutableDictionary *params = [NSMutableDictionary dictionary];

    if ([to length] &gt; 0) {
        params[@"Mode"] = @"Voice";
        params[@"PhoneNumber"] = phoneNumber;
    }

    TVOConnectOptions *connectOptions = [TVOConnectOptions optionsWithAccessToken:accessToken
        block:^(TVOConnectOptionsBuilder *builder) {
            builder.params = params;
            builder.uuid = uuid;
            builder.region = region;
    }];

    self.call = [TwilioVoice connectWithOptions:connectOptions delegate:self];
}

#pragma mark - TVOCallDelegate

- (void)callDidStartRinging:(TVOCall *)call {
    NSLog(@"Call is ringing at called party %@", call.to);
}

- (void)call:(TVOCall *)call didFailToConnectWithError:(NSError *)error {
    NSLog("Failed to Connect the Call: %@\n\t  - reason: %@", [error localizedDescription], [error localizedFailureReason]);
}

- (void)call:(TVOCall *)call didDisconnectWithError:(NSError *)error {
    if (error) {
        NSLog(@"Call disconnected with error: %@", error);
    } else {
        NSLog(@"Call disconnected");
    }
}

- (void)callDidConnect:(TVOCall *)call {
    NSLog(@"Call connected.");
}
</code></pre>

<p>@end</p>
			</div>
			

			

			
			<div class="method-subsection see-also-section">
				<h4 class="method-subtitle">See Also</h4>
				<ul>
					
					<li><code><p><a href="../Classes/TVOCall.html">TVOCall</a></p></code></li>
					
					<li><code><p><a href="../Protocols/TVOCallDelegate.html">TVOCallDelegate</a></p></code></li>
					
					<li><code><p><a href="../Classes/TVOConnectOptions.html">TVOConnectOptions</a></p></code></li>
					
				</ul>
			</div>
			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">TwilioVoice.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						
					</div>
					
					

                    
				</main>

				<footer>
					<div class="footer-copyright">
						
						<p class="copyright">Copyright &copy; 2019 Twilio. All rights reserved. Updated: 2019-03-18</p>
						
						
						<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1334)</a>.</p>
						
					</div>
				</footer>
			</div>
		</div>
	</article>

	<script src="../js/script.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2900316-33', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>